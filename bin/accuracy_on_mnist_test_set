#!/usr/bin/env python

import os, sys, argparse

sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), "..")))
from datasets import mnist
from models import train, accuracy, load_from_file

argument_parser = argparse.ArgumentParser()
argument_parser.add_argument("--model", nargs="+", dest="model_paths", required=True)
arguments = argument_parser.parse_args()

_, _, X_test, y_test = mnist()
model_paths = arguments.model_paths
for path in model_paths:
    model = load_from_file(path)
    test_set_accuracy = accuracy(model, X_test, y_test)
    print(f"{path} -> {test_set_accuracy}")
